<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard RH & Paie</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        h1 { text-align: center; }
        h2 { margin-top: 40px; }
        table { border-collapse: collapse; width: 100%; margin-top: 10px; background: white; }
        th, td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }
        th { background-color: #333; color: white; text-align: left; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .section { margin-bottom: 40px; padding: 15px; box-shadow: 0 0 5px rgba(0,0,0,0.1); background: white; }
        .tag { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 12px; }
        .etat-en-cours { background: #e3f2fd; color: #1565c0; }
        .etat-termine { background: #e8f5e9; color: #2e7d32; }
        .etat-annule { background: #ffebee; color: #c62828; }
    </style>
</head>
<body>

<h1>Dashboard Gestion RH & Paie</h1>

<div class="section" id="departements">
    <h2>Départements</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>ID Chef de département</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="d : ${departements}">
            <td th:text="${d.idDepartement}"></td>
            <td th:text="${d.nomDepartement}"></td>
            <td th:text="${d.idChefDepartement}">-</td>
        </tr>
        </tbody>
    </table>
</div>

<div class="section" id="employees">
    <h2>Employés</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Prénom</th>
            <th>Nom</th>
            <th>Genre</th>
            <th>Email</th>
            <th>Poste</th>
            <th>Grade</th>
            <th>Département</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="e : ${employees}">
            <td th:text="${e.id}"></td>
            <td th:text="${e.fname}"></td>
            <td th:text="${e.sname}"></td>
            <td th:text="${e.gender}"></td>
            <td th:text="${e.email}"></td>
            <td th:text="${e.position}"></td>
            <td th:text="${e.grade}"></td>
            <td th:text="${e.departement != null ? e.departement.nomDepartement : '—'}"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="section" id="projets">
    <h2>Projets</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>Date début</th>
            <th>Date fin</th>
            <th>État</th>
            <th>Chef de projet</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="p : ${projets}">
            <td th:text="${p.idProjet}"></td>
            <td th:text="${p.nomProjet}"></td>
            <td th:text="${p.dateDebut}"></td>
            <td th:text="${p.dateFin}"></td>
            <td>
                <span th:text="${p.etat}"
                      th:classappend="${p.etat} == 'En cours' ? 'tag etat-en-cours' :
                                      (${p.etat} == 'Terminé' ? 'tag etat-termine' :
                                      'tag etat-annule')">
                </span>
            </td>
            <td th:text="${p.chefProjet != null ? p.chefProjet.fname + ' ' + p.chefProjet.sname : '—'}"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="section" id="payrolls">
    <h2>Fiches de paie</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Employé</th>
            <th>Date</th>
            <th>Salaire</th>
            <th>Net à payer</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="p : ${payrolls}">
            <td th:text="${p.idPayroll}"></td>
            <td th:text="${p.employee != null ? p.employee.fname + ' ' + p.employee.sname : '—'}"></td>
            <td th:text="${p.date}"></td>
            <td th:text="${p.salary}"></td>
            <td th:text="${p.netPay}"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="section" id="roles">
    <h2>Rôles</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Nom du rôle</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="r : ${roles}">
            <td th:text="${r.idRole}"></td>
            <td th:text="${r.nomRole}"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="section" id="payroll-lines">
    <h2>Lignes de paie (Primes / Déductions)</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Montant</th>
            <th>Libellé</th>
            <th>Type</th>
            <th>ID Payroll</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="l : ${payrollLines}">
            <td th:text="${l.idLine}"></td>
            <td th:text="${l.amount}"></td>
            <td th:text="${l.label}"></td>
            <td th:text="${l.typeList}"></td>
            <td th:text="${l.payroll != null ? l.payroll.idPayroll : '—'}"></td>
        </tr>
        </tbody>
    </table>
</div>

</body>
</html>
